;written by Bianxiao Cui in Oct 2000;modified by Bianxiao Cui in Jan. 3rd, 2001;use sumdata instead of trackfl, the input maxdis is in the unit of diameter;same as gr_1D except the unit of input maxdis;;BL 12/31/02 adding printing maxdispro gr_1D,sumdata_mv=sumdata_mv,resolution=resolution,$       maxdis=maxdis,diameter=diameter,ratio=ratio,nframes=nframes, $       nfiles=nfilesif keyword_set(diameter) then diameter=diameter $   else diameter=1.58  ; in the unit of umif keyword_set(ratio) then ratio=ratio $   else ratio=0.169if keyword_set(nframes) then nframes=nframes $   else nframes=5000.if keyword_set(sumdata_mv) then file=findfile(sumdata_mv) $   else file=findfile('subset_sumdata*')if keyword_set(nfiles) then nfiles=nfiles $   else nfiles=n_elements(file)   print,'the number of sumdata files found:',nfilesif keyword_set(resolution) then resolution=resolution $ else resolution=0.1                ;in the unit of pixelif keyword_set(maxdis) then maxdis=maxdis*diameter/ratio $    else maxdis=diameter*8./ratio     ;8 times of the diameterprint,maxdis,' in diameters; di=',diameter,'; re=',resolution,'; ration=',ratiodis_s=strmid(strtrim(string(maxdis),1),0,1)print,' in c_gr_1d;, maxdis=',maxdis,'in pixels';blmaxdis=float(maxdis)/resolution  ;the points in the gr filehist=fltarr(nfiles,maxdis)print,'the max distance of gr is:',maxdis*resolution*ratio,' in um'      ;in the unit of umxran=[10./resolution+maxdis,(640.-10.)/resolution-maxdis]if xran(0) ge xran(1) then message,'Maxdis too large!!!'xx=findgen(maxdis)*resolution*ratio/diameternpar=0.goodnpar=fltarr(nfiles)total_nf=0.for nf=0,nfiles-1 do begin    print,'mv#',nf    sumdata=read_gdf(file(nf))    nfr=nframes < max(sumdata(5,*))+1.    total_nf=total_nf+nfr         for f=0,nfr-1 do begin        w=where(sumdata(5,*) eq f,count)        npar=npar+count         x=reform(sumdata(0,w))/resolution        goodx=where((x gt xran(0)) and (x le xran(1)),goodn)        goodnpar[nf]=goodnpar[nf]+goodn        nx=n_elements(x)                for i=0,goodn-1 do begin            for j=0,nx-1 do begin               if j ne goodx(i) then begin                  dis=(x(j)-x(goodx(i)))                  dis=fix(abs(dis),type=3)                  if dis le maxdis-1 then hist(nf,dis)=hist(nf,dis)+1.               endif             endfor         endfor     endfor;f	;plot to see the improvement of the statistics   	 hist_p=total(hist,1)/total(goodnpar) 	density=npar/total_nf/(640.-2.*10.)*resolution        	;average nparticles per resolution of pixel	 plot,xx,hist_p/density/2.  write_gdf,[transpose(xx),hist[nf,*]],'gr_'+strmid(file(nf),8);if nf gt 50 then write_gdf,[transpose(xx),transpose(hist_p/density/2.)],'gr_dis'+dis_s+'_'+strtrim(string(nf),1)+'mvs'endfor;nf  hist=total(hist,1)/total(goodnpar) density=npar/total_nf/(640.-2.*10.)*resolution        ;average nparticles per resolution of pixel plot,xx,hist/density/2. gr=[transpose(xx),transpose(hist/density/2.)]print,goodnparif nfiles ge 1 then write_gdf,goodnpar,'gr_nptls' write_gdf,gr,'gr_total'end        